<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>
      PN Search
    </title>
    <link rel="stylesheet" href="/css/master.css" type="text/css" media="screen" title="no title" charset="utf-8">
    <link rel="stylesheet" href="/css/custom-theme/jquery-ui-1.8.14.custom.css" type="text/css" media="screen" title="no title" charset="utf-8">
    <link rel="stylesheet" href="/css/jquery.bubblepopup.v2.1.5.css" type="text/css" media="screen" title="no title" charset="utf-8">
    <script src="/js/jquery-1.5.1.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/js/jquery-ui-1.8.14.custom.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/js/jquery.bubblepopup.v2.1.5.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="/js/jquery.cookie.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-19774706-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>

  </head>
  <body onload="init()">
    <div id="d">
      <div id="hd">
        <h1>DCLP</h1>
        <h2 class="mode">Navigator | <a href="/editor">Editor</a></h2>
      </div>
      <div id="bd">
        <div class="nav">
          <!-- left nav -->
          <form method="get" accept-charset="utf-8">
            <ul class="nav">
              <li>Browse: </li>
              <li>
                <a href="/browse/ddbdp/">DDbDP</a>
              </li>
              <li>
                <a href="/browse/hgv/">HGV</a>
              </li>
              <li>
                <a href="/browse/apis/">APIS</a>
              </li>
              <li>
                <a href="/browse/dclp/">DCLP</a>
              </li>
              <li>
                <a href="/authors">Authors</a>
              </li>
              <li class="dialog" id="tm" title="TM Number" ><div id="tmc">TM#: <input type="text" name="tmid" id="tmid" onclick="this.setAttribute('value','');this.focus();" size="10"/> <input onclick="window.location='/trismegistos/'+jQuery('#tmid').attr('value');" type="button" name="tmgo" id="tmgo" value=" &gt; " /></div>
              </li>
              <li>or</li>
              <li class="current">
                <a href="/search">Search</a>
              </li>
            </ul>
          </form>
        </div>
        <div id="main">
          <div class="content search">
            <!-- Search form -->
            <h2>Search</h2>
            <form action="/search" method="post" accept-charset="UTF-8" name="searchform">
              <div id="search-form-wrapper">
                <div>
                <div>
                <p style="background:white;border:thin solid silver;padding:1em;width:780px" class="ui-corner-all"><input type="text" name="keyword" value="" id="keyword" size="70"> in <select name="target" id="target" onchange="if(this.selectedIndex!=1 && this.form.substring.checked){jQuery('#phrase,#phrase-label').trigger('click')}" size="1">
                  <option value="all">
                    All
                  </option>
                  <option value="text" selected>
                    Text
                  </option>
                  <option value="metadata">
                    Metadata
                  </option>
                  <option value="translation">
                    Translations
                  </option>
                </select> <input type="submit" value="Search" id="search"></p>
                <p>
                  <a href="#" class="button" id="showeg">Examples</a>
                  <input type="checkbox" id="togglehelp" onchange="toggleHelp()" autocomplete="off"><label for="togglehelp" id="togglehelp-label">Tool-Tips</label>

                </p>
                </div>
                <div>
                  <h3>Type</h3>
                  <p><input class="type" type="radio" name="type" value="phrase" id="phrase" onchange="if(this.checked){this.form.target.selectedIndex=0}"> <label for="phrase" id="phrase-label">phrase search</label> <input class="type" class="type" type="radio" name="type" value="substring" id="substring" checked onchange="if(this.checked){this.form.target.selectedIndex=1}"> <label for="substring" id="substring-label">substring search</label> <input class="type" type="radio" name="type" value="proximity" id="proximity"> <label for="proximity" id="proximity-label">find within</label> <input type="text" name="within" value="10" id="within" size="2" style="width:1.5em"> words</p>
                </div>
                <div id="search-options">
                  <h3>Options</h3>
                  <p><input type="checkbox" name="beta" id="betaYes" value="on"> <label for="betaYes" id="betaYes-label">search text in Beta Code</label>
                    <br/><input type="checkbox" name="caps" id="caps" value="on" checked> <label for="caps" id="caps-label">ignore capitalization</label>
                    <br/><input type="checkbox" name="marks" id="marks" value="on" checked> <label for="marks" id="marks-label">ignore diacritics/accents</label>
                    <br/><input type="checkbox" name="lemmas" id="lemmas" onchange="if(this.checked){this.form.caps.disabled=true;this.form.marks.disabled=true;this.form.target.selectedIndex=1;jQuery('#phrase,#phrase-label').trigger('click');}"> <label for="lemmas" id="lemmas-label">lemmatized search</label></p>
                    <p><b>Sort results by:</b>
                      <br/><input type="checkbox" name="imagesfirst" value="yes" id="imagesfirst"> <label for="imagesfirst" id="imagesfirst-label">images first</label>
                      <br/><input type="checkbox" name="translationsfirst" value="" id="translationsfirst"> <label for="translationsfirst" id="translationsfirst-label">translations first</label> </p></div>
              </div>
              <div>
                <h3>Filters</h3>
                <p><label for="provenance">Provenance:</label> <input type="text" name="provenance" value="" id="provenance"></p>
                <p>Date <label for="date_start">on or after</label> <input type="text/submit/hidden/button" name="date_start" value="" id="date_start"> <select name="start_era" id="start_era" onchange="" size="1">
                  <option value="bce">
                    BCE
                  </option>
                  <option value="ce">
                    CE
                  </option>
                </select> <label for="date_end">on or before</label> <input type="text" name="date_end" value="" id="date_end"> <select name="end_era" id="end_era" onchange="" size="1">
                  <option value="bce">
                    BCE
                  </option>
                  <option value="ce">
                    CE
                  </option>
                </select></p>
                <p><label for="ddbseries">DDbDP Series:</label> <select name="ddbseries" id="ddbseries" onchange="" size="1"><option value="">All</option>
                </select>  <!-- <label for="hgvseries">HGV Series:</label> <select name="hgvseries" id="hgvseries" onchange="" size="1"><option value="">All</option>
                  </select> --><label for="volume">Volume:</label> <input type="text" name="volume" id="volume" size="3"></p>
                <p><label for="apiscol">Collection:</label> <select name="apiscol" id="apiscol" onchange="" size="1"><option value="">All</option>
                </select> <label for="invnum"><strong>Inventory Number <span class="pn-note">(where available)</span></strong></label> <input id="invnum" name="invnum" size="5" maxlength="25" value="" type="text"> <span class="comment" style="font-weight: normal;">e.g."186a"</span></p>

              </div>

                </div><!-- close #search-form-wrapper -->
            </form><!-- Search form end -->
          </div>
          <div id="help">
            <div id="phrase-help">Phrase search uses the query syntax built in to the Lucene search engine.  For example, you can do wildcard searches using * for multiple missing characters and ? for a single missing character (e.g. Καισ*).  Phrase searches can ignore or use diacritics and capitalization.  Wildcards cannot appear at the beginning of a word. For more details, see <a href="http://lucene.apache.org/java/3_0_2/queryparsersyntax.html">Lucene query syntax</a>.</div>
            <div id="substring-help">Substring searches look for text occurring anywhere in a word, even in the middle.  Use the ^ character to mark a word-boundary (e.g. "^και^ ^υπο"). Terms must be at least 3 characters long (carets included). To search for one term followed by another, enclose the whole search string in quotes.  Substring searches do not take diacritics or capitalization into account.</div>
            <div id="proximity-help">Proximity searches look for terms near to one another, within the specified number of words.</div>
            <div id="betaYes-help">Beta code allows you to search for Greek characters using a non-Greek character set. The following Roman alphabet characters represent the Greek equivalences:
              <ul>
                <li>η (eta) = h</li>
                <li>θ (theta) = q</li>
                <li>ξ (xi) = c</li>
                <li>χ (chi) = x</li>
                <li>ψ (psi) = y</li>
                <li>ω (omega) = w</li>
                <li>σ (medial sigma) = s1</li>
              </ul>
            </div>
            <div id="lemmas-help">Lemmatized Search searches for all forms of the entered dictionary headword (Greek only for now). For words that have lemmas identical to other words (like δέω, e.g.), you may append a number corresponding to the article's order in LSJ. If you do not append a number, the search will be done on all forms of all corresponding lemmas.</div>
          </div>
          <div id="examples" style="display:none;text-align:left">
            <h3>Lemmatized searches</h3>
            <ul>
              <li><a href="#" class="eg" id="lemma_eg">find all forms of λύω</a></li>
              <li><a href="#" class="eg" id="lemma_plus_eg">find all forms of λύω + Φιλώτας</a></li>
            </ul>
            <h3>Substring Searches</h3>
            <ul>
              <li><a href="#" class="eg" id="substring_anchor_eg">^στρατηγ / finds e.g. στρατηγo but not επιστρατηγο</a></li>
              <li><a href="#" class="eg" id="substring_anchor_beta_eg">^strathg / finds e.g. στρατηγo but not επιστρατηγο (search text is in Beta Code)</a></li>
              <li><a href="#" class="eg" id="substring_eg">στρατηγ / finds e.g. στρατηγo and επιστρατηγο</a></li>
              <li><a href="#" class="eg" id="substring_anchors_eg">^των^ / finds only των</a></li>
              <li><a href="#" class="eg" id="substring_end_anchor_eg">των^ / finds e.g. ὑπαρχόντων but not τῶνδε</a></li>
              <li><a href="#" class="eg" id="substring_anchor_multi_eg">"men^ ^ka" / finds e.g. ἀπέχομεν καὶ</a></li>
            </ul>
            <h3>Phrase searches</h3>
            <ul>
              <li><a href="#" class="eg" id="phrase_eg">στρατηγ* / finds e.g. στρατηγo but not επιστρατηγο</a></li>
              <li><a href="#" class="eg" id="phrase_beta_eg">epi*men / finds e.g. ἐπιδεδώκαμεν (search text is in Beta Code)</a></li>
              <li><a href="#" class="eg" id="phrase_multi_eg">"αναγκαιας χρειας" / finds e.g. ἀναγκαία̣ς χ[ρ]είας</a></li>
            </ul>
            <h3>Boolean searches</h3>
            <ul>
              <li><a href="#" class="eg" id="substring_boolean_eg">^καισ NOT ^καισαρ</a></li>
              <li><a href="#" class="eg" id="phrase_boolean_eg">στρατηγου OR στρατηγω</a></li>
              <li><a href="#" class="eg" id="substring_and_eg">^καισ ^σεβαστ (AND is the default)</a></li>
            </ul>
            <h3>Proximity searches</h3>
            <ul>
              <li><a href="#" class="eg" id="proximity_eg">αναγκαιας χρειας / finds e.g. ἀναγκαίας μου χρείας</a></li>
            </ul>
          </div>
        </div>
      </div>
  <div id="footer">
      <div id="footer-left-col">
        <div id="secondary-nav">
          <ul class="nav">
            <li><a href="/" title="Project Home">Home</a></li>
            <li><a href="/docs/help" title="Site help">Help</a></li>
            <!-- following two links SoSOL only -->
            <!-- <li><a href="">Leiden<sup>+</sup> Text Help</a></li> -->
            <!-- <li><a href="">Leiden<sup>+</sup> Translation Help</a></li> -->
            <!-- insert link for SoSOL admin email here -->
            <li><a href="http://digitalpapyrology.blogspot.com/" title="Digital Papyrology">Blog</a></li>
            <li><a href="/docs/resources" title="Papyrological tools and resources">Resources</a></li>
            <li><a href="/feedback.html" title="Feeback">Feedback</a></li>
            <li><a href="http://epidoc.sourceforge.net/" title="EpiDoc Home">About EpiDoc</a></li>
          </ul>
        </div>
        <div class="spacer"></div>
      </div>
      <div id="footer-right-col">
        <p>Produced by</p>
        <p><a href="http://blogs.library.duke.edu/dcthree/">The Duke Collaboratory for Classics Computing</a>
          <br/>&amp; the <a href="http://www.nyu.edu/isaw/">Institute for the Study of the
          Ancient World</a></p>
        <div id="about-nav">
          <ul class="nav">
            <li><a href="http://www.trismegistos.org/" title="Trismegistos Home">Trismegistos</a></li>
            <li><a href="http://www.rzuser.uni-heidelberg.de/%7Egv0/" title="Heidelberger Gesamtverzeichnis
              der Griechischen Papyrusurkunden Ägyptens - Home ">HGV</a></li>
            <li><a href="/docs/ddbdp" title="Duke Databank of Documentary Papyri - Home">DDbDP</a></li>
            <li><a href="/docs/apis">APIS</a></li>
            <li class="last-child"><a href="/docs/about" title="Papyri.info">Papyri.info</a></li>
          </ul>
          <h3 id="about-hdr">About:</h3>
        </div>
      </div>
      <div class="spacer"></div>
    </div>
  </div>

    <script type="text/javascript" charset="utf-8">
      jQuery("a.button").button();
      jQuery("#tmgo").button();
      jQuery("#togglehelp,#search,#newsearch").button();
      jQuery("#newsearch").click(function(){
        jQuery("#hidesearch").show();
        jQuery(this).hide();
      });
      jQuery("div#hd").click(function() {window.location = "/"});
      jQuery("#showeg").click(function() {
        jQuery("#examples").dialog({
          position:["right","top"]
        });
        jQuery("#examples").show();
      });
      jQuery.getJSON("/ddbdp/json", function(data) {
        var series = jQuery("#ddbseries");
        jQuery.each(data.results.bindings, function(i, row) {
          var val = row.object.value.substr(row.object.value.lastIndexOf("/") + 1);
          series.append('<option value="' + val + '">'+ val + '</option');
        })
      });
      //jQuery.getJSON("/hgv/json", function(data) {
      //  var series = jQuery("#hgvseries");
      //  jQuery.each(data.results.bindings, function(i, row) {
      //    var val = row.object.value.substr(row.object.value.lastIndexOf("/") + 1);
      //    series.append('<option value="' + val + '">'+ val + '</option');
      //  })
      //});
      jQuery.getJSON("/apis/json", function(data) {
        var apis = jQuery("#apiscol");
        jQuery.each(data.results.bindings, function(i, row) {
          var val = row.object.value.substr(row.object.value.lastIndexOf("/") + 1);
          apis.append('<option value="' + val + '">'+ val + '</option');
        })
      });
      //Make the whole result row clickable
      jQuery("tr.result-record").hover(
        function(){
          highlightSearchResultRow(jQuery(this));
        },
        function(){
          jQuery(this).css('background-color', "white");
          jQuery(this).next("tr.result-text").css('background-color', "white");
        });
        jQuery("tr.result-text").hover(
          function(){
            highlightSearchResultRow(jQuery(this).prev());
          },
          function(){
            jQuery(this).css('background-color', "white");
            jQuery(this).prev("tr.result-record").css('background-color', "white");
      });
      //make page links clickable
      jQuery("div.page").not(".current").hover(function(){
        jQuery(this).css({'background-color': '#ebf1e8', 'cursor': 'pointer'});
        jQuery(this).click(function(){window.location = jQuery(this).find("a").attr("href")});
      }, function(){
        jQuery(this).css({'background-color': '#f9f9f9', 'cursor': 'default'});
      });

      /**
      * The following are functions to store search settings in cookies.
      *
      * As matters stand this might seem like an over-engineered solution. However, it can
      * be very easily expanded to accomodate the other search settings on the form, rather than
      * simply the betacode setting. However, the ideal behaviour and interactions amongst
      * these settings are not yet decided upon.
      *
      * Expansion of functionality would involve:
      * (1) defining a new search_setting object corresponding to the relevant search setting
      * in initSearchCookies
      * (2) Ensuring that a cookie for this search setting is set in cookifySearchSettings
      * retrieveSearchSettings should then be able to take care of everything else automatically -
      * though note it will only work for form elements with a "checked" attribute
      *
      *
      * @author thill
      * @version 2011.06.02
      *
      */


      function initSearchCookies(){

      		search_settings = {};
      		search_settings.betacode = {};
      		search_settings.betacode.name = "beta_on";
      		search_settings.betacode.element = "#betaYes";

      }


      function cookifySearchSettings(){

      	jQuery.cookie(search_settings.betacode.name, jQuery("input[name='beta']").attr("checked").toString());

      }

      function retrieveSearchSettings(){

      	jQuery.each(search_settings, function(setting, setting_values){

      		var cookie_name = setting_values["name"];
      		var element = setting_values["element"];
      		if(jQuery.cookie(cookie_name) && jQuery.cookie(cookie_name) != jQuery(element).attr("checked").toString()){

      			jQuery(element).trigger("click");
      			jQuery(element + "-label").trigger("click");

      		}

      	});

      }

      /* end search-setting cookie funcs */

      var help = false;
      function init() {

        initSearchCookies();
      	retrieveSearchSettings();

        jQuery("li.dialog").each(function(i) {
          jQuery(this).after("<li><a href=\"#\" onclick=\"javascript:jQuery('#"+this.id+"').dialog()\">"+this.title+"<\/a><\/li>");
          jQuery(this).hide();
        });
        jQuery("#togglehelp-label").CreateBubblePopup({
          innerHtml: "Click to turn contextual help for the search form on and off.",
          position: "right"
        });
        jQuery("ul.nav li").not(".dialog").not($("#footer ul.nav li")).not(".current").has("a").hover(function() {
              jQuery(this).css('background-color', '#F8F6F4');
          },
          function() {
              jQuery(this).css('background-color', 'transparent');
        });
        jQuery("#search").click(cookifySearchSettings);
      }

      function toggleHelp() {
        if(!help) {
          help = true;
          jQuery("#help div").each(function() {
            var helptext = this.innerHTML;
            //alert("#" + this.id.substring(0, this.id.indexOf("-")) + "-span");
            var label = jQuery("#" + this.id.substring(0, this.id.indexOf("-")) + "-label");
            label.CreateBubblePopup(
                  {
                     innerHtml: helptext,
                     innerHtmlStyle: {
                       'text-align':'left'
                       },
                     width: 350,
                     position: label.offset().left > 600? "left" : "right",
                     closingDelay: 2000
                  });
          });
        } else {
          help = false;
          jQuery("#help div").each(function() {
            jQuery("#" + this.id.substring(0, this.id.indexOf("-")) + "-label").RemoveBubblePopup();
          });
        }
      }
      function highlightSearchResultRow(row) {
        row.css({'background-color': '#ebf1e8', 'cursor': 'pointer'});
        row.click(function(){window.location = row.find("a").attr("href")});
        row.next("tr.result-text").css({'background-color': '#ebf1e8', 'cursor': 'pointer'});
        row.next("tr.result-text").click(function(){window.location = row.find("a").attr("href")});
      }
      function removeSearchResultHighlight(row) {
        row.css({'background-color': 'white', 'cursor': 'default'});
        row.next("tr.result-text").css({'background-color': 'white', 'cursor': 'default'});
      }
      function setupSearch(opts) {
        resetSearch();
        for (var property in opts) {
          var elt = jQuery("#" + property);
          if (opts[property] == true || opts[property] == false) {
            if (elt[0].checked != opts[property]) {
              jQuery("#" + property + ",#" + property + "-label").trigger("click");
            }
          }
          else if (isNaN(opts[property])) {
            elt[0].value = opts[property];
          } else {
            if (elt.is("select")) {
              elt[0].selectedIndex = opts[property];
            } else {
              elt[0].value = opts[property];
            }
          }
        }
      }
      function resetSearch() {
        if (jQuery("#phrase")[0].checked){
          jQuery("#phrase,#phrase-label").trigger("click");
        }
        if (!jQuery("#substring")[0].checked){
          jQuery("#substring,#substring-label").trigger("click");
        }
        if (jQuery("#proximity")[0].checked){
          jQuery("#proximity,#proximity-label").trigger("click");
        }
        jQuery("#keyword")[0].value = "";
        jQuery("#target")[0].selectedIndex = 1;
        if (jQuery("#betaYes")[0].checked){
          jQuery("#betaYes,#betaYes-label").trigger("click");
        }
        if (!jQuery("#caps")[0].checked){
          jQuery("#caps,#caps-label").trigger("click");
        }
        if (!jQuery("#marks")[0].checked){
          jQuery("#marks,#marks-label").trigger("click");
        }
        if (jQuery("#lemmas")[0].checked){
          jQuery("#lemmas,#lemmas-label").trigger("click");
        }
      }
      jQuery("#lemma_eg").click(function() {
        setupSearch(
          {keyword:"λύω",
           lemmas:true,
           phrase:true})
      });
      jQuery("#lemma_plus_eg").click(function() {
        setupSearch(
          {keyword:"transcription_l:λύω φιλωτας",
           phrase:true})
      });
      jQuery("#substring_anchor_eg").click(function() {
        setupSearch(
          {keyword:"^στρατηγ",
           substring:true})
      });
      jQuery("#substring_anchor_beta_eg").click(function() {
        setupSearch(
          {keyword:"^strathg",
           substring:true,
           betaYes:true})
      });
      jQuery("#substring_eg").click(function() {
        setupSearch(
          {keyword:"στρατηγ",
           substring:true})
      });
      jQuery("#substring_anchors_eg").click(function() {
        setupSearch(
          {keyword:"^των^",
           substring:true})
      });
      jQuery("#substring_end_anchor_eg").click(function() {
        setupSearch(
          {keyword:"των^",
           substring:true})
      });
      jQuery("#substring_anchor_multi_eg").click(function() {
        setupSearch(
          {keyword:"\"men^ ^ka\"",
           substring:true,
           betaYes:true})
      });
      jQuery("#phrase_eg").click(function() {
        setupSearch(
          {keyword:"στρατηγ*",
           phrase:true})
      });
      jQuery("#phrase_beta_eg").click(function() {
        setupSearch(
          {keyword:"epi*men",
           phrase:true,
           betaYes:true})
      });
      jQuery("#phrase_multi_eg").click(function() {
        setupSearch(
          {keyword:"\"αναγκαιας χρειας\"",
           phrase:true})
      });
      jQuery("#substring_boolean_eg").click(function() {
        setupSearch(
          {keyword:"^καισ NOT ^καισαρ",
           substring:true})
      });
      jQuery("#phrase_boolean_eg").click(function() {
        setupSearch(
          {keyword:"στρατηγου OR στρατηγω",
           phrase:true})
      });
      jQuery("#substring_and_eg").click(function() {
        setupSearch(
          {keyword:"^καισ ^σεβαστ",
           substring:true})
      });
      jQuery("#proximity_eg").click(function() {
        setupSearch(
          {keyword:"αναγκαιας χρειας",
           proximity:true,
           within:"3"})
      });
    </script>
  </body>
</html>
